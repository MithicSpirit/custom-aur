# Maintainer: MithicSpirit <rpc01234 at gmail dot com>
# Contributor: Andy Kluger <https://t.me/andykluger>
# Contributor: Markus Weimar <mail@markusweimar.de>

_pkgname=iosevka
pkgname=ttc-${_pkgname}-mithic
_commit_id=\
896f72c4a1daa39c80d2f140710061b9269fbde7
_pkgname_id="${_pkgname}-${_commit_id}"
pkgver=22.1.0.0
pkgrel=1
replaces=("ttf-${pkgname##ttc-}")
pkgdesc='A custom monospace sans-serif typeface inspired by Pragmata Pro, M+, PF DIN Mono.'
arch=('any')
url='https://be5invis.github.io/Iosevka/'
license=('custom:OFL')
makedepends=('nodejs>=12.22.0' 'npm' 'ttfautohint')
source=("${_pkgname_id}.tar.gz::https://github.com/MithicSpirit/${_pkgname}/archive/${_commit_id}.tar.gz"
        get-makeflags.js)
sha512sums=('0db6dad26a74cd9dba4c165a5f76011989a75ce0f7c35048477b44b217a305491d46894d7ec25797a5f250ea4a4380706cdf328baba98667bb1cd05ec9cf7b00'
            '167a2da7b6cb06b6b96b4ae204f46e67e4625052df065873158455b0dedc75d2c0080cd39be33da49a984febccff892b3e59e4626d41364e3a8b9865efbd725f')

build () {
	cd "${srcdir}/${_pkgname_id}"
	npm install

	local _makeflags="$(../get-makeflags.js)"
	[[ -z "$_makeflags" ]] && _makeflags="--jCmd=1"

	npm run build -- "$_makeflags" super-ttc::iosevka-mithic
}

package () {
	cd "${srcdir}/${_pkgname_id}"
	install -d "${pkgdir}/usr/share/fonts/TTF/"
	install -m644 dist/.super-ttc/*.ttc "${pkgdir}/usr/share/fonts/TTF/"
	install -d "${pkgdir}/usr/share/licenses/${pkgname}"
	install -m644 LICENSE.md "${pkgdir}/usr/share/licenses/${pkgname}/"
}
